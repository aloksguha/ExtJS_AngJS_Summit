<!DOCTYPE html>
<html>
<head>
    <title>Synerzip's HTML5 Summit</title>
    <link rel="stylesheet" href="/resources/css/main.css"/>
</head>
<body>
<section class='container'>
    <header class='header'>
        <img class='logo' src='/resources/images/synerzip-logo-hi-res.gif'></img>
    </header>
    <a href="/index.html">Return to Main Page</a>
    <hr/>
    <article>
        <img src="backbone.png" width="" height=""></img>
        <hr/>

    </article>
    <section class="content">
        <article>
            <h1><span>Backbone Routers</span></h1>
            <hr/>
        </article>
        <article>
            <h1><a name="TOC">Table of Contents</a></h1>
            <ul>
                <li><a href="#basics">Basics</a></li>
                <li><a href="#routers">Backbone Routers</a></li>
                <li><a href="#history">Backbone History</a></li>
                <li><a href="#example">KinoEdu example using routers</a></li>

            </ul>
            <hr/>
        </article>
        <article>


            <h3 class="topic"><a name="basics">Basics</a></h3>

            <p>
                If you want to make reference to certain ‘state’ or location of the web application, you need a reference (link/URL) to it. <br/>
                This is where routers come to rescue. <br/> <br/>

                Routing in most of JS application are achieved by hash-tags. <br/>
                E.g. If you take a look of Gmail URL you will see something like:  <br/> <br/>

                https://mail.google.com/mail/u/0/#inbox/139c0d48e11d986b  <br/> <br/>

                where the <b>#inbox/139c0d48e11d986b</b> is the hash-tag which reference some email location.
            </p>
            <a href="#TOC">Table of Contents</a>
            <hr/>
        </article>
        <article>


            <h3 class="topic"><a name="routers">Backbone Routers</a></h3>
            <p>

            <ul>
                <li>Provides linkable, bookmarkable, shareable URLs for important locations in the app</li>
                <li>Provides methods for routing client-side pages, and connecting them to actions and events</li>
            </ul>
            </p>

        </article>
        <article>
            <h4>Define</h4>
            <p>
                Get started by creating a custom router class. <br/>
                Define actions that are triggered when certain URL fragments are matched, and provide a routes hash that pairs routes to actions
            </p>
            <b><u>Javascript Source</u></b>
            <pre class="code">
             var Workspace = Backbone.Router.extend({

                  routes: {
                        "help":                 "help",    // #help
                        "search/:query":        "search",  // #search/kiwis
                        "search/:query/p:page": "search"   // #search/kiwis/p7
                  },

                  help: function() {
                    ...
                  },

                  search: function(query, page) {
                    ...
                  }

            });
            </pre>

            <h4>Routes</h4>

            <p>
                The routes hash maps URLs with parameters to functions on your router<br/> <br/>
                Routes can contain
                <ul>
                    <li>Parameter parts <b>:param</b> which match a single URL component between slashes </li>
                    <li>Splat parts <b>*splat</b> which can match any number of URL components</li>
                    <li>Optional parts <b>(/:optional)</b> part of a route can be made optional by surrounding it in parentheses</li>
                </ul>
             </p>

            <b>For example</b>

                <p style="margin-left: 50px;">
                    A route of "<b>search/:query/p:page</b>" <br/>
                    will match a fragment of #search/obama/p2, <br/>
                    passing "obama" and "2" to the action.<br/>
                </p>
                <p style="margin-left: 50px;">
                    A route of "<b>file/*path</b>" <br/>
                    will match #file/nested/folder/file.txt, <br/>
                    passing "nested/folder/file.txt" to the action.<br/>
                </p>
                <p style="margin-left: 50px;">
                    A route of "<b>docs/:section(/:subsection)</b>" <br/>
                    will match #docs/faq and #docs/faq/installing, <br/>
                    passing "faq" to the action in the first case, and passing "faq" and "installing" to the action in the second.<br/>
                </p>


            <h4>Route</h4>

            <p>
                Manually create a route for the router
            </p>
            <b><u>Javascript Source</u></b>
            <pre class="code">
                initialize: function(options) {

                      // Matches #page/10, passing "10"
                      this.route("page/:number", "page", function(number){ ... });

                }
            </pre>


            <h4>Navigate</h4>

            <p>
               Whenever you reach a point in your application that you'd like to save as a URL, call navigate in order to update the URL.<br/>
                If you wish to also call the route function, set the trigger option to true. <br/>
                To update the URL without creating an entry in the browser's history, set the replace option to true. <br/>
            </p>
            <b><u>Javascript Source</u></b>
            <pre class="code">
                openPage: function(pageNumber) {
                      this.document.pages.at(pageNumber).open();
                      this.navigate("page/" + pageNumber);
                }

                # Or ...

                app.navigate("help/troubleshooting", {trigger: true});

                # Or ...

                app.navigate("help/troubleshooting", {trigger: true, replace: true});
            </pre>
            <a href="#TOC">Table of Contents</a>
            <hr/>
        </article>

        <article>
            <h3 class="topic"><a name="history">Backbone History</a></h3>
            <p>
                History serves as a global router (per frame) to handle hashchange events, match the appropriate route, and trigger callbacks<br/>
                After creating all of its routers, be sure to call Backbone.history.start() to route the initial URL.
            </p>

            <h4>Start</h4>

            <p>                                                                         0.
                When all of your Routers have been created, and all of the routes are set up properly, call Backbone.history.start() to begin monitoring hashchange events, and dispatching routes.
            </p>
            <b><u>Javascript Source</u></b>
            <pre class="code">
                Backbone.history.start()
            </pre>
            <a href="#TOC">Table of Contents</a>
            <hr/>
        </article>

        <article>
            <h3 class="topic"><a name="example">KinoEdu example using routers</a> - <a href="chapter-1/index.html" target="_blank">Launch</a></h3>
            <iframe src="chapter-1/index.html" width="100%" height="520px"></iframe>

            <b><u>Javascript Source</u></b>
            <br/>index.js
            <pre class="code">

                appView = new AppView({
                    el: $("#page-content")
                });

                var AppRouter = Backbone.Router.extend({

                    routes: {
                        "viewMode/:type": "changeViewMode",  // #search/HTML5
                        "search/:query": "searchCourse"  // #search/HTML5                                    .

                    },

                    changeViewMode: function(type) {
                        if(type=="list"){
                            appView.listView();
                        } else {
                            appView.gridView();
                        }
                    },

                    searchCourse: function(query) {
                        appView.filterCourses(query);
                    }

                });

                //Create router instance
                appRouter = new AppRouter;

                //Start history to monitor hash change events
                Backbone.history.start();
            </pre>


            appTpl.html
            <pre  style="border:1px solid black;margin:20px;padding:20px">
&lt;div class=&quot;toolbar&quot;&gt;<br/>    &lt;span&gt;Search:&lt;/span&gt; &lt;input class=&quot;search&quot; type=&quot;text&quot; /&gt;<br/>    &lt;span class=&quot;toggle-button&quot;&gt;<br/>        &lt;a href=&quot;#viewMode/grid&quot; class=&quot;grid-view active&quot;&gt;Grid&lt;/a&gt;<br/>        &lt;a href=&quot;#viewMode/list&quot; class=&quot;list-view&quot;&gt;List&lt;/a&gt;<br/>    &lt;/span&gt;<br/>&lt;/div&gt;
            </pre>
            appView.js
            <pre class="code">
                var appView = Backbone.View.extend({
                    ...

                    //remove DOM event binding for toggle buttons
                    events: {
                        "keyup input.search": "filter",
                        //"click .grid-view": "gridView",
                        //"click .list-view": "listView",
                        "click .save-btn": "saveCourse"
                    },

                ...
                )};
            </pre>
            <a href="#TOC">Table of Contents</a>
            <hr/>
        </article>
    </section>
</section>

</body>
</html>