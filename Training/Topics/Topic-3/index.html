<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/html" xmlns="http://www.w3.org/1999/html" xmlns="http://www.w3.org/1999/html"
      xmlns="http://www.w3.org/1999/html">
<head>
    <title>Synerzip's HTML5 Summit</title>
    <link rel="stylesheet" href="/resources/css/main.css"/>
</head>
<body>

<section class='container'>
<header class='header'>
    <img class='logo' src='/resources/images/synerzip-logo-hi-res.gif'></img>
</header>
<a href="/index.html">Return to Main Page</a>
<hr/>
<section class="content">

<article>
    <img src="http://requirejs.org/i/logo.png" width="" height=""></img>
    <h6 style="margin: 0px;padding: 0 0 0 33px"><i>A Javascript Module Loader</i></h6>
    <hr/>

</article>
<article>
    <h1><a name="TOC">Table of Contents</a></h1>
    <ul>
        <li><a href="#problems">Problems</a></li>
        <li><a href="#solutions">Solution</a></li>
        <li><a href="#traditional">Example of Library Management without RequireJS</a></li>
        <li><a href="#requirejs">RequireJS</a></li>
        <li><a href="#module">What is a Module?</a></li>
        <li><a href="#usingRequireJs">Example of Library Management using RequireJS</a></li>
        <li><a href="#requireJsConfigure">RequireJS Configuration</a></li>
        <li><a href="#mixingNonRequireJs">Mixing Non RequireJS Modules with RequireJS</a></li>
        <li><a href="#optimizing-part-1">Optimizing RequireJS Projects - Part 1</a></li>
        <li><a href="#optimizing-part-2">Optimizing RequireJS Projects - Part 2</a></li>
        <li><a href="#umd">Moving forward to Universal Module Definition </a></li>
    </ul>
    <hr/>
</article>

<article>
    <h3 class="topic"><a name="problems">Problems</a></h3>

    <p>
        Problems with traditional websites.
    <ul>
        <li>Not so well organized code</li>
        <li>Code complexity grows as the site gets bigger</li>
        <li>Nested Dependencies</li>
        <li>Deployment wants optimized code in just one or a few HTTP calls</li>
        <li>No way to include/import/require </li>
    </ul>

    <h4> Vomit of script tag (puke) </h4>

    <img src="scriptTagCall.png" width="800px" height="500px"/>

    <h4> Need few HTTP calls :( </h4>
    <img src="speed.png" width="800px" height="500px"/>
    </p>
    <a href="#TOC">Table of Contents</a>
    <hr/>
</article>

<article>
    <h3 class="topic"><a name="solutions">What we want? / Solution</a> </h3>

    <ul>
        <li>Well organized code</li>
        <li>Ability to load nested dependencies</li>
        <li>Some sort of #import/include/require</li>
        <li>Few HTTP calls</li>
    </ul>
    <a href="#TOC">Table of Contents</a>
    <hr/>
</article>

<!--Example of WithoutRequireJS Program-->
<article>
    <h3 class="topic"><a name="tradition">Library Management Example (in traditional way)<a/></h3>
    <p>
        <b><u>Class Dependency</u></b>
        <p>
            Let's look at the Classes in the below example and the dependency in them
            <img src="Library-Design.png" width="50%" height="50%"></img>
        </p>
    </p>
    <p>
        <b><u>Live Example</u></b>
        <p>
            <iframe src="chapter-1/index.html" width="100%" height="550px"></iframe>
        </p>
    </p>
    <b><u>Directory Structure</u></b>
    <pre class="code">
  chapter-1/
  ├── models/
  │   ├── Author.js
  │   ├── Book.js
  │   ├── BookIssue.js
  │   ├── Library.js
  │   ├── Publisher.js
  │   ├── User.js
  │   ├── Book.js
  ├── app.js
  ├── index.html
    </pre>

    <b><u>JavaScript files (in reverse order)</u></b>
    <pre class="code">
/**
 * Author constructor
 * @param name - The name of the Author
 * @constructor
 */
var Author = function(authorName){

    /**
     * Private Member Variable
     */
    var name = authorName;

    /**
     * Set Author name
     * @param name
     */
    this.setName = function(authorName){
        name = authorName;
    }

    /**
     * Get Author name
     * @return name
     */
    this.getName = function(){
        return name;
    }
}
    </pre>
    <pre class="code">

/**
 * Publisher constructor
 * @param name - The name of the publisher
 * @constructor
 */
var Publisher = function(publisherName){
    /**
     * Private Member Variable
     */
    var name = publisherName;

    /**
     * Set Publisher name
     * @param name
     */
    this.setName = function(publisherName){
        name = publisherName;
    }

    /**
     * Get Publisher name
     * @return name
     */
    this.getName = function(){
        return name;
    }
}
    </pre>
    <pre class="code">

/**
 * Book constructor
 * @param name - The name of the Book
 * @constructor
 */
var Book = function(bookName,publisherName, authorName){
    /**
     * Private Member Variables
     */
    var name = bookName;
    var publisher = new Publisher(publisherName);
    var author = new Author(authorName);

    /**
     * Set Book name
     * @param name
     */
    this.setName = function(bookName){
        name = bookName;
    }

    /**
     * Get Book name
     * @return name
     */
    this.getName = function(){
        return name;
    }

    /**
     * Set Publisher of the book
     * @param bookPublisher {Publisher}
     */
    this.setPublisher = function(bookPublisher){
        publisher = bookPublisher;
    }

    /**
     * Get the Publisher of the book
     * @return {Publisher}
     */
    this.getPublisher = function(){
        return publisher;
    }

    /**
     * Set the Author of the Book
     * @param bookAuthor {Author}
     */
    this.setAuthor = function(bookAuthor){
        author = bookAuthor;
    }

    /**
     * Get the Author of the Book
     * @return {Author}
     */
    this.getAuthor = function(){
        return author;
    }

}
    </pre>
    <pre class="code">

/**
 * User constructor
 * @param name - The name of the User
 * @constructor
 */
var User = function(UserName){

    /**
     * Private Member Variable
     */
    var name = UserName;

    /**
     * Set User name
     * @param name
     */
    this.setName = function(UserName){
        name = UserName;
    }

    /**
     * Get User name
     * @return name
     */
    this.getName = function(){
        return name;
    }
}
    </pre>
    <pre class="code">
/**
 * Book constructor
 * @param name - The name of the Book
 * @constructor
 */
var BookIssue = function(bookTobeIssued,userTobeIssuedTo){
    /**
     * Private Member Variables
     */
    var book = bookTobeIssued;
    var user = userTobeIssuedTo;


    /**
     * Set Book
     * @param bookTobeIssued {Book}
     */
    this.setBook = function(bookTobeIssued){
        book = bookTobeIssued;
    }

    /**
     * Get Book
     * @return {Book} name
     */
    this.getBook = function(){
        return book;
    }

    /**
     * Set User
     * @param userTobeIssuedTo {user}
     */
    this.setUser = function(userTobeIssuedTo){
        user = userTobeIssuedTo;
    }

    /**
     * Get User
     * @return {User}
     */
    this.getUser = function(){
        return user;
    }


}
    </pre>
    <pre class="code">
/**
 * Library constructor
 * @param name - The name of the Library
 * @constructor
 */
var Library = function(libBooks, libUsers){

    /**
     * Private Member variables
     */
    var books = libBooks || [];
    var users = libUsers || [];
    var bookIssues = [];

    /**
     * Get Books in Library
     * @return {Book|Array}
     */
    this.getBooks = function(){
        return books;
    }

    /**
     * Set Books in Library
     * @param {Book|Array} libBooks
     */
    this.setBooks = function(libBooks){
        books = libBooks;
    }

    /**
     * Add a book to the library
     * @param {Book} book
     */
    this.addBook = function(book){
        books.push(book);
    }

    /**
     * Get Users in Library
     * @return {User|Array}
     */
    this.getUsers = function(){
        return users;
    }

    /**
     * Set Users in Library
     * @param {User|Array} libUsers
     */
    this.setUsers = function(libUsers){
        users = libUsers;
    }

    /**
     * Add a User to the Library
     * @param {User} user
     */
    this.addUser = function(user){
        users.push(user);
    }

    /**
     * Issue a Book to a given User
     * @param {Book} book
     * @param {User} user
     */
    this.issueBook = function(book, user){
        bookIssues.push(new BookIssue(book,user));
    }

    /**
     * Get All the Issued books
     * @return {BookIssue|Array}
     */
    this.getIssuedBooks = function(){
        return bookIssues;
    }



}
    </pre>
    <pre class="code">

var books = [
            new Book('Android Basics','Apress','Tim Roberts'),
            new Book('iOS Basics','Packt','Jim Allens'),
            new Book('Getting Started with HTML5','Oreilly','Bob Martin')
        ]

var users = [
            new User('Sadik Rupani'),
            new User('Rohit Ghatol')
        ]


var library = new Library(books, users);

library.issueBook(books[1],users[1]);


console.log("Fetching All Books from Library");
var allBooks = library.getBooks();
var html = "";
for(var index=0;index<allBooks.length;index++){
    var book = allBooks[index];
    console.log(index+'-' +book.getName() +" From "+book.getPublisher().getName()+" By "+book.getAuthor().getName());
    html = html + "<li>"+book.getName() +" From "+book.getPublisher().getName()+" By "+book.getAuthor().getName()+"</li>";
}
var booksUlElem = document.getElementById("books");
booksUlElem.innerHTML = html;


console.log("Fetching All Users from Library");
var allUsers = library.getUsers();
html = ""
for(var index=0;index<allUsers.length;index++){
    var user = allUsers[index];
    console.log(index+'-' +user.getName());
    html = html + "<li>"+user.getName()+"</li>";
}
var usersUlElem = document.getElementById("users");
usersUlElem.innerHTML = html;


console.log("Fetching All Books Issued");
var issuedBooks = library.getIssuedBooks()
html = ""
for(var index=0;index<issuedBooks.length;index++){
    var bookIssue = issuedBooks[index];
    console.log(index+'- Book ' +bookIssue.getBook().getName()+" Issued to "+bookIssue.getUser().getName());
    html = html + "<li>Book - " +bookIssue.getBook().getName()+" Issued to "+bookIssue.getUser().getName()+"</li>";
}

var booksIssuedUlElem = document.getElementById("booksIssued");
booksIssuedUlElem.innerHTML = html;

    </pre>

    <b><u>HTML Code</u></b>
    <pre class="code">
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Synerzip's HTML5 Summit&lt;/title&gt;
    &lt;link rel="stylesheet" href="/resources/css/main.css"/&gt;
    &lt;script type="text/javascript" src="models/Author.js"&gt;&lt;/script&gt;
    &lt;script type="text/javascript" src="models/Publisher.js"&gt;&lt;/script&gt;
    &lt;script type="text/javascript" src="models/Book.js"&gt;&lt;/script&gt;
    &lt;script type="text/javascript" src="models/User.js"&gt;&lt;/script&gt;
    &lt;script type="text/javascript" src="models/BookIssue.js"&gt;&lt;/script&gt;

    &lt;script type="text/javascript" src="models/Library.js"&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;section class='container'&gt;
    &lt;header class='header'&gt;
        &lt;img class='logo' src='/resources/images/synerzip-logo-hi-res.gif'&gt;&lt;/img&gt;
    &lt;/header&gt;
    &lt;hr/&gt;
    &lt;section class="content"&gt;
        &lt;article&gt;
            &lt;h3 class="topic"&gt;Library Example&lt;/h3&gt;

            &lt;h4&gt;Books&lt;/h4&gt;
            &lt;ul id="books"&gt;

            &lt;/ul&gt;

            &lt;h4&gt;Users&lt;/h4&gt;
            &lt;ul id="users"&gt;

            &lt;/ul&gt;

            &lt;h4&gt;BooksIssued&lt;/h4&gt;
            &lt;ul id="booksIssued"&gt;

            &lt;/ul&gt;

        &lt;/article&gt;
    &lt;/section&gt;
&lt;/section&gt;
&lt;script type="text/javascript" src="app.js"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
    </pre>
    <hr/>
</article>

<article>
    <h3 class="topic"><a name="requirejs">RequireJS</a></h3>
    <p>
        <span>What is RequireJS?</span>
        <ul style="list-style-type: none">
            <li>RequireJS is a JavaScript file and module loader.</li>
        </ul>

    </p>
    <p>
        <span>What does RequireJS?</span>
        <ul>
            <li>Improve the speed</li>
            <li>Improve the quality of code</li>
        </ul>
    </p>
    <p>
        <h3>Add RequireJS in your project</h3>
        <p>Here I assume that you keep all your JavaScript files in a "scripts" directory in your project. For example, if you've a project that has an <i>index.html</i> page, with some scripts, the directory layout might look like so:</p>
        <pre class="code">
chapter-1/
├── models/
│   ├── Author.js
│   ├── Book.js
│   ├── BookIssue.js
│   ├── Library.js
│   ├── Publisher.js
│   ├── User.js
│   ├── Book.js
├── app.js
├── index.html
        </pre>
        <p>Add require.js to the scripts directory,so it look like so : </p>
        <pre class="code">
chapter-1/
├── models/
│   ├── Author.js
│   ├── Book.js
│   ├── BookIssue.js
│   ├── Library.js
│   ├── Publisher.js
│   ├── User.js
│   ├── Book.js
├── app.js
├── require.js
├── index.html
        </pre>
        <p>To take full advantage of the optimization tool, it is suggested that you keep all inline script out of the HTML, and only reference require.js with a require call like so to load your script:</p>
        <pre class="code">
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Synerzip's HTML5 Summit&lt;/title&gt;
    &lt;link rel="stylesheet" href="/resources/css/main.css"/&gt;

&lt;/head&gt;
&lt;body&gt;

&lt;section class='container'&gt;
    ....
&lt;/section&gt;
&lt;script type="text/javascript" src="require.js" data-main="app.js"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
        </pre>
        <p>RequireJS loads all code relative to a <i>baseUrl</i>. The baseUrl is normally set to the same directory as the script used in a data-main attribute for the top level script to load for a page. The data-main attribute is a special attribute that require.js will check to start script loading. .</p>
        <p>Inside of app.js, you can use require() to load any other scripts you need to run:</p>
        <pre class="code">
require(['models/Library', 'models/User', 'models/Book', 'models/BookIssue']
    , function (Library, User, Book, BookIssue) {
        var books = [
            new Book('Android Basics', 'Apress', 'Tim Roberts'),
            new Book('iOS Basics', 'Packt', 'Jim Allens'),
            new Book('Getting Started with HTML5', 'Oreilly', 'Bob Martin')
        ]

        var users = [
            new User('Sadik Rupani'),
            new User('Rohit Ghatol')
        ]


        var library = new Library(books, users);

        library.issueBook(books[1], users[1]);


        console.log("Fetching All Books from Library");
        var allBooks = library.getBooks();
        var html = "";
        for (var index = 0; index < allBooks.length; index++) {
            var book = allBooks[index];
            console.log(index + '-' + book.getName() + " From " + book.getPublisher().getName() + " By " + book.getAuthor().getName());
            html = html + "<li>" + book.getName() + " From " + book.getPublisher().getName() + " By " + book.getAuthor().getName() + "</li>";
        }
        var booksUlElem = document.getElementById("books");
        booksUlElem.innerHTML = html;


        console.log("Fetching All Users from Library");
        var allUsers = library.getUsers();
        html = ""
        for (var index = 0; index < allUsers.length; index++) {
            var user = allUsers[index];
            console.log(index + '-' + user.getName());
            html = html + "<li>" + user.getName() + "</li>";
        }
        var usersUlElem = document.getElementById("users");
        usersUlElem.innerHTML = html;


        console.log("Fetching All Books Issued");
        var issuedBooks = library.getIssuedBooks()
        html = ""
        for (var index = 0; index < issuedBooks.length; index++) {
            var bookIssue = issuedBooks[index];
            console.log(index + '- Book ' + bookIssue.getBook().getName() + " Issued to " + bookIssue.getUser().getName());
            html = html + "<li>Book - " + bookIssue.getBook().getName() + " Issued to " + bookIssue.getUser().getName() + "</li>";
        }

        var booksIssuedUlElem = document.getElementById("booksIssued");
        booksIssuedUlElem.innerHTML = html;

    });
        </pre>
    </p>
    <a href="#TOC">Table of Contents</a>
    <hr/>
</article>
<article>
    <h3 class="topic"><a name="module">What is module?</a></h3>
    <p>RequireJS is modular loader. It takes a different approach to script loading than traditional <pre>&lt;script&gt;</pre> tags. Its primary goal is to encoureage modular code,and as part of that, it encourages using module IDs instead of URLs for script tages.  </p>
    <p>A module is different from a traditional script file in that it defines a well-scoped object that avoids polluting the global namespace. It can explicitly list its dependencies and get a handle on those dependencies without needing to refer to global objects, but instead receice the dependencies as arguments to the function that defines the module.</p>

    <h3>How to define module? </h3>
    <ul>
        <li>Simple Name/Value Pairs</li>
              <pre class="code">
                  define({
                    color : "White",
                    size : "M"
                  });
              </pre>

        <li>Definition Functions</li>
              <pre class="code">
                    define(function(){

                        return {
                            color : "White",
                            size : "M"
                        }

                    });
              </pre>
        <li>Definition Functions with Dependencies</li>
              <pre class="code">
                  define(["./cart","./inventory"],function(){
                        return {
                             color : "White",
                             size : "M",
                             addToCart : function(){
                                inventory.decrement(this);
                                cart.add(this);
                             }
                        }
                  });
              </pre>
        <li>Define Module as a Function</li>
              <pre class="code">
                  define(['models/Publisher', 'models/Author'],
                    function (Publisher, Author) {

                        /**
                         * Book constructor
                         * @param name - The name of the Book
                         * @constructor
                         */

                        var Book = function (bookName, publisherName, authorName) {
                            /**
                             * Private Member Variables
                             */
                            var name = bookName;
                            var publisher = new Publisher(publisherName);
                            var author = new Author(authorName);



                        }
                        return Book;
                    });

              </pre>
          </ul>
    <a href="#TOC">Table of Contents</a>
    <hr/>
</article>

<!--Example of WithRequireJS Program-->
<article>
<h3 class="topic"><a name="usingRequireJs">Library Management Example (with RequireJs)</a></h3>
<iframe src="chapter-2/index.html" width="100%" height="550px"></iframe>
<b><u>Directory Structure</u></b>
    <pre class="code">
  chapter-1/
  ├── models/
  │   ├── Author.js
  │   ├── Book.js
  │   ├── BookIssue.js
  │   ├── Library.js
  │   ├── Publisher.js
  │   ├── User.js
  │   ├── Book.js
  ├── app.js
  ├── index.html
  ├── require.js
    </pre>

<b><u>JavaScript files (in reverse order)</u></b>
    <pre class="code">
define([], function () {
    /**
     * Author constructor
     * @param name - The name of the Author
     * @constructor
     */
    var Author = function (authorName) {

        /**
         * Private Member Variable
         */
        var name = authorName;

        /**
         * Set Author name
         * @param name
         */
        this.setName = function (authorName) {
            name = authorName;
        }

        /**
         * Get Author name
         * @return name
         */
        this.getName = function () {
            return name;
        }
    }

    return Author;
});

    </pre>
    <pre class="code">

define([], function () {

    /**
     * Publisher constructor
     * @param name - The name of the publisher
     * @constructor
     */
    var Publisher = function (publisherName) {
        /**
         * Private Member Variable
         */
        var name = publisherName;

        /**
         * Set Publisher name
         * @param name
         */
        this.setName = function (publisherName) {
            name = publisherName;
        }

        /**
         * Get Publisher name
         * @return name
         */
        this.getName = function () {
            return name;
        }
    }
    return Publisher;
})
    </pre>
    <pre class="code">

define(['models/Publisher', 'models/Author'],
    function (Publisher, Author) {

        /**
         * Book constructor
         * @param name - The name of the Book
         * @constructor
         */

        var Book = function (bookName, publisherName, authorName) {
            /**
             * Private Member Variables
             */
            var name = bookName;
            var publisher = new Publisher(publisherName);
            var author = new Author(authorName);

            /**
             * Set Book name
             * @param name
             */
            this.setName = function (bookName) {
                name = bookName;
            }

            /**
             * Get Book name
             * @return name
             */
            this.getName = function () {
                return name;
            }

            /**
             * Set Publisher of the book
             * @param bookPublisher {Publisher}
             */
            this.setPublisher = function (bookPublisher) {
                publisher = bookPublisher;
            }

            /**
             * Get the Publisher of the book
             * @return {Publisher}
             */
            this.getPublisher = function () {
                return publisher;
            }

            /**
             * Set the Author of the Book
             * @param bookAuthor {Author}
             */
            this.setAuthor = function (bookAuthor) {
                author = bookAuthor;
            }

            /**
             * Get the Author of the Book
             * @return {Author}
             */
            this.getAuthor = function () {
                return author;
            }

        }
        return Book;
    });
    </pre>
    <pre class="code">


define([], function(){

    /**
     * User constructor
     * @param name - The name of the User
     * @constructor
     */
    var User = function(UserName){

        /**
         * Private Member Variable
         */
        var name = UserName;

        /**
         * Set User name
         * @param name
         */
        this.setName = function(UserName){
            name = UserName;
        }

        /**
         * Get User name
         * @return name
         */
        this.getName = function(){
            return name;
        }
    }
    return User;
})

    </pre>
    <pre class="code">
define(['models/Book', 'models/User'],
    function (Book, User) {

        /**
         * BookIssue constructor
         * @param bookTobeIssued - The book to be Issue
         * @param userTobeIssuedTo - The user to be Issued to
         * @constructor
         */
        var BookIssue = function (bookTobeIssued, userTobeIssuedTo) {
            /**
             * Private Member Variables
             */
            var book = bookTobeIssued;
            var user = userTobeIssuedTo;


            /**
             * Set Book
             * @param bookTobeIssued {Book}
             */
            this.setBook = function (bookTobeIssued) {
                book = bookTobeIssued;
            }

            /**
             * Get Book
             * @return {Book} name
             */
            this.getBook = function () {
                return book;
            }

            /**
             * Set User
             * @param userTobeIssuedTo {user}
             */
            this.setUser = function (userTobeIssuedTo) {
                user = userTobeIssuedTo;
            }

            /**
             * Get User
             * @return {User}
             */
            this.getUser = function () {
                return user;
            }


        }
        return BookIssue;
    })

    </pre>
    <pre class="code">
define(['models/User', 'models/Book', 'models/BookIssue'],
    function(User,Book, BookIssue){

    /**
     * Library constructor
     * @param name - The name of the Library
     * @constructor
     */

    var Library = function(libBooks, libUsers){

        /**
         * Private Member variables
         */
        var books = libBooks || [];
        var users = libUsers || [];
        var bookIssues = [];

        /**
         * Get Books in Library
         * @return {Book|Array}
         */
        this.getBooks = function(){
            return books;
        }

        /**
         * Set Books in Library
         * @param {Book|Array} libBooks
         */
        this.setBooks = function(libBooks){
            books = libBooks;
        }

        /**
         * Add a book to the library
         * @param {Book} book
         */
        this.addBook = function(book){
            books.push(book);
        }

        /**
         * Get Users in Library
         * @return {User|Array}
         */
        this.getUsers = function(){
            return users;
        }

        /**
         * Set Users in Library
         * @param {User|Array} libUsers
         */
        this.setUsers = function(libUsers){
            users = libUsers;
        }

        /**
         * Add a User to the Library
         * @param {User} user
         */
        this.addUser = function(user){
            users.push(user);
        }

        /**
         * Issue a Book to a given User
         * @param {Book} book
         * @param {User} user
         */
        this.issueBook = function(book, user){
            bookIssues.push(new BookIssue(book,user));
        }

        /**
         * Get All the Issued books
         * @return {BookIssue|Array}
         */
        this.getIssuedBooks = function(){
            return bookIssues;
        }



    }
    return Library;
})

    </pre>
    <pre class="code">
require(['models/Library', 'models/User', 'models/Book', 'models/BookIssue']
    , function (Library, User, Book, BookIssue) {
        var books = [
            new Book('Android Basics', 'Apress', 'Tim Roberts'),
            new Book('iOS Basics', 'Packt', 'Jim Allens'),
            new Book('Getting Started with HTML5', 'Oreilly', 'Bob Martin')
        ]

        var users = [
            new User('Sadik Rupani'),
            new User('Rohit Ghatol')
        ]


        var library = new Library(books, users);

        library.issueBook(books[1], users[1]);


        console.log("Fetching All Books from Library");
        var allBooks = library.getBooks();
        var html = "";
        for (var index = 0; index < allBooks.length; index++) {
            var book = allBooks[index];
            console.log(index + '-' + book.getName() + " From " + book.getPublisher().getName() + " By " + book.getAuthor().getName());
            html = html + "<li>" + book.getName() + " From " + book.getPublisher().getName() + " By " + book.getAuthor().getName() + "</li>";
        }
        var booksUlElem = document.getElementById("books");
        booksUlElem.innerHTML = html;


        console.log("Fetching All Users from Library");
        var allUsers = library.getUsers();
        html = ""
        for (var index = 0; index < allUsers.length; index++) {
            var user = allUsers[index];
            console.log(index + '-' + user.getName());
            html = html + "<li>" + user.getName() + "</li>";
        }
        var usersUlElem = document.getElementById("users");
        usersUlElem.innerHTML = html;


        console.log("Fetching All Books Issued");
        var issuedBooks = library.getIssuedBooks()
        html = ""
        for (var index = 0; index < issuedBooks.length; index++) {
            var bookIssue = issuedBooks[index];
            console.log(index + '- Book ' + bookIssue.getBook().getName() + " Issued to " + bookIssue.getUser().getName());
            html = html + "<li>Book - " + bookIssue.getBook().getName() + " Issued to " + bookIssue.getUser().getName() + "</li>";
        }

        var booksIssuedUlElem = document.getElementById("booksIssued");
        booksIssuedUlElem.innerHTML = html;

    });
    </pre>

<b><u>HTML Code</u></b>
    <pre class="code">
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Synerzip's HTML5 Summit&lt;/title&gt;
    &lt;link rel="stylesheet" href="/resources/css/main.css"/&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;section class='container'&gt;
    &lt;header class='header'&gt;
        &lt;img class='logo' src='/resources/images/synerzip-logo-hi-res.gif'&gt;&lt;/img&gt;
    &lt;/header&gt;
    &lt;hr/&gt;
    &lt;section class="content"&gt;
        &lt;article&gt;
            &lt;h3 class="topic"&gt;Library Example&lt;/h3&gt;

            &lt;h4&gt;Books&lt;/h4&gt;
            &lt;ul id="books"&gt;

            &lt;/ul&gt;

            &lt;h4&gt;Users&lt;/h4&gt;
            &lt;ul id="users"&gt;

            &lt;/ul&gt;

            &lt;h4&gt;BooksIssued&lt;/h4&gt;
            &lt;ul id="booksIssued"&gt;

            &lt;/ul&gt;

        &lt;/article&gt;


    &lt;/section&gt;
&lt;/section&gt;
&lt;script type="text/javascript" src="require.js" data-main="app.js"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
    </pre>
    <a href="#TOC">Table of Contents</a>
<hr/>
</article>

<!--Example of WithRequireJS and Configuration Program-->
<article>
    <h3 class="topic"><a name="requireJsConfigure">Library Management Example (with RequireJs and RequireJs Configuration)</a></h3>
    <p>
        So far we have seen how to use RequireJs to convert our javascript files and classes into Modules.
        However you will also note, how we had to tell RequireJs to import our modules by complete path 'models/Book'.
        Now Imagine yourself using not only our own classes but third party library too and you get some thing like following

    <pre class="code">
define(['lib/jquery/jquery-1.7.2.min','lib/underscore/underscore-1.4.3/min','models/Book'],
    function($,_,Book){
});
    </pre>

    You can obviously see it is very painful to write complete paths each time. Well you can tell RequireJs to create alias for you
    <pre class="code">
require.config({
    paths: {
        "jquery": "lib/jquery/jquery-1.7.2.min",
        "underscore":"lib/underscore/underscore-1.4.3/min"
        "book": "models/Book",
        ...
    }

});
    </pre>
    With this configuration,now the above code converts to what is shown below
    <pre class="code">
define(['jquery','underscore','models/Book'],
    function($,_,Book){
});
    </pre>

    See the complete example below
    </p>
    <iframe src="chapter-3/index.html" width="100%" height="550px"></iframe>

    <b><u>Changed JavaScript files</u></b>
<pre class="code">
require.config({
    paths: {
        "library": "models/Library",
        "user": "models/User",
        "book": "models/Book",
        "bookIssue": "models/BookIssue",
        "author": "models/Author",
        "publisher": "models/Publisher"
    }

});
require(['library', 'user', 'book', 'bookIssue']
    , function (Library, User, Book, BookIssue) {
       .....

    });
    </pre>

    <pre class="code">

define(['publisher', 'author'],
    function (Publisher, Author) {

        .....
    });
    </pre>

    <pre class="code">
define(['book', 'user'],
    function (Book, User) {

        .....
    })

    </pre>
    <pre class="code">
define(['user', 'book', 'bookIssue'],
    function(User,Book, BookIssue){

    .....
})

    </pre>


    <a href="#TOC">Table of Contents</a>
    <hr/>
</article>


<!--Example of Using Non RequireJS Module with RequireJs-->
<article>
<h3 class="topic"><a name="mixingNonRequireJs">Library Management Example - Mixing Non RequireJs Module with RequireJs Module</a></h3>
<p>
    One thing you must have observed till now is that we need to convert all our javascript files to
    RequireJs Module files. This works for us as long as the source code is under our control. Say a
    situation arises when you have to use a JavaScript library which is a Require Js Module.

    Question - How do you mix and match RequireJs Module with Non RequireJs Modules.

    Here's How?

    We have added a Logger.js file to the project
    <pre class="code">
  chapter-1/
  ├── models/
  │   ├── Author.js
  │   ├── Book.js
  │   ├── BookIssue.js
  │   ├── Library.js
  │   ├── Publisher.js
  │   ├── User.js
  │   ├── Book.js
  ├── utils/
  │   ├── Logger.js
  ├── app.js
  ├── index.html
  ├── require.js
    </pre>

    Following is the source code for Logger.js. Note it is not a RequireJS Module and note how
    conveniently it pollutes the global namespace by saying equivalent of
    "window.Logger = function(){...}". We will use this to our advantage.

    <pre class="code">
/**
 * Create Log Level with one of the Log Levels - Info,Warn,Debug, Error
 * @param logLevel
 * @constructor
 */
var Logger = function(logLevel){
    var level = logLevel || 'Info';

    /**
     * Log the given message
     * @param message
     */
    this.log=function(message){
        console.log(level+'  :  '+message);
    }
}
    </pre>

    What we will do now, is configure the RequireJs Path and something called a Shim.
    A Shim is a fallback or workaround for exactly these situation, when you want to mix
    Non RequireJs Module with RequireJs Module

    What we are saying here in english is if you load 'logger' module and do not find it returning
    anything (in RequireJs manner), go ahead and return the global object 'logger' aka 'window.logger'

    <pre class="code">
require.config({
    paths: {
        "logger":"utils/Logger",
        "library": "models/Library",
        "user": "models/User",
        "book": "models/Book",
        "bookIssue": "models/BookIssue",
        "author": "models/Author",
        "publisher": "models/Publisher"
    },
    shim: {
        'logger': {
            exports: 'Logger'
        }
    }

});
    </pre>

    Lets see all the modifications we have done to all our classes below.
    Notice now we are using logger.log instead of console.log

    <pre class="code">

require.config({
    paths: {
        "logger":"utils/Logger",
        "library": "models/Library",
        "user": "models/User",
        "book": "models/Book",
        "bookIssue": "models/BookIssue",
        "author": "models/Author",
        "publisher": "models/Publisher"
    },
    shim: {
        'logger': {
            exports: 'Logger'
        }
    }

});
require(['library', 'user', 'book', 'bookIssue','logger']
    , function (Library, User, Book, BookIssue,Logger) {

        var logger = new Logger('Debug');

        var books = [
            new Book('Android Basics', 'Apress', 'Tim Roberts'),
            new Book('iOS Basics', 'Packt', 'Jim Allens'),
            new Book('Getting Started with HTML5', 'Oreilly', 'Bob Martin')
        ]

        var users = [
            new User('Sadik Rupani'),
            new User('Rohit Ghatol')
        ]


        var library = new Library(books, users);

        library.issueBook(books[1], users[1]);


        logger.log("Fetching All Books from Library");
        var allBooks = library.getBooks();
        var html = "";
        for (var index = 0; index < allBooks.length; index++) {
            var book = allBooks[index];
            logger.log(index + '-' + book.getName() + " From " + book.getPublisher().getName() + " By " + book.getAuthor().getName());
            html = html + "<li>" + book.getName() + " From " + book.getPublisher().getName() + " By " + book.getAuthor().getName() + "</li>";
        }
        var booksUlElem = document.getElementById("books");
        booksUlElem.innerHTML = html;


        logger.log("Fetching All Users from Library");
        var allUsers = library.getUsers();
        html = ""
        for (var index = 0; index < allUsers.length; index++) {
            var user = allUsers[index];
            logger.log(index + '-' + user.getName());
            html = html + "<li>" + user.getName() + "</li>";
        }
        var usersUlElem = document.getElementById("users");
        usersUlElem.innerHTML = html;


        logger.log("Fetching All Books Issued");
        var issuedBooks = library.getIssuedBooks()
        html = ""
        for (var index = 0; index < issuedBooks.length; index++) {
            var bookIssue = issuedBooks[index];
            logger.log(index + '- Book ' + bookIssue.getBook().getName() + " Issued to " + bookIssue.getUser().getName());
            html = html + "<li>Book - " + bookIssue.getBook().getName() + " Issued to " + bookIssue.getUser().getName() + "</li>";
        }

        var booksIssuedUlElem = document.getElementById("booksIssued");
        booksIssuedUlElem.innerHTML = html;

    });
    </pre>


    <a href="#TOC">Table of Contents</a>
<hr/>
</article>

<!--Example of RequireJs Optimization -->
<article>
    <h3 class="topic"><a name="optimizing-part-1">Optimizing RequireJs Application - Part 1 </a></h3>
    <p>
        When the browser loads the app it actually loads up all the javascript files. More the number of javascript files
        slower the application gets.
        <pre class="code">
app/
├── models/
│   ├── Author.js
│   ├── Book.js
│   ├── BookIssue.js
│   ├── Library.js
│   ├── Publisher.js
│   ├── User.js
│   ├── Book.js
├── utils/
│   ├── Logger.js
├── app.js
├── index.html
├── require.js
        </pre>

        What we would instead desire is browser loading up something like follows.
        Where app.min.js is a single javascript file which holds all the code.
        Browser will load the page faster by making a single trip to load this unified, minified and obfuscated javascript file.
        <pre class="code">
app/
├── app.min.js
├── index.html
├── require.js
        </pre>

        In order to achieve that we will take the following steps
        <b><u>Step 1</u></b>
        <p>
            Download r.js from requirejs and put in the application directory as shown below
            <pre class="code">
app/
├── models/
│   ├── Author.js
│   ├── Book.js
│   ├── BookIssue.js
│   ├── Library.js
│   ├── Publisher.js
│   ├── User.js
│   ├── Book.js
├── utils/
│   ├── Logger.js
├── app.js
├── index.html
├── r.js
├── require.js
            </pre>
        </p>
        <b><u>Step 2</u></b>
        <p>
            Create a new file called build.js and place it next to r.js
            <pre class="code">
app/
├── models/
│   ├── Author.js
│   ├── Book.js
│   ├── BookIssue.js
│   ├── Library.js
│   ├── Publisher.js
│   ├── User.js
│   ├── Book.js
├── utils/
│   ├── Logger.js
├── app.js
├── build.js
├── index.html
├── r.js
├── require.js
            </pre>

            The contents of build.js should be as follows. Note
            the paths and shim section are copied from app.js
            <pre class="code">
({
    baseUrl: ".",
    paths: {
        "logger":"utils/Logger",
        "library": "models/Library",
        "user": "models/User",
        "book": "models/Book",
        "bookIssue": "models/BookIssue",
        "author": "models/Author",
        "publisher": "models/Publisher"
    },
    shim: {
        'logger': {
            exports: 'Logger'
        }
    },
    name: "app",
    out: "app.min.js"
})

            </pre>
        </p>
        <b><u>Step 3</u></b>
        <p>
            Run the following command
            <pre class="code">
$> node r.js -o build.js
            </pre>
            This will generate a new file called app.min.js
        </p>
        <b><u>Step 4</u></b>
        <p>
            Modify index.html to use app.min.js instead of app.js
            <pre class="code">
&lt;script type="text/javascript" src="require.js" data-main="app.min.js"&gt;&lt;/script&gt;
            </pre>
        </p>
    </p>
    <a href="#TOC">Table of Contents</a>
</article>


<!--Example of RequireJs Optimization -->
<article>
    <h3 class="topic"><a name="optimizing-part-2">Optimizing RequireJs Application - Part 2</a> </h3>
    <p>
        Note in the earlier example we had to manually modify the index.html to change "app.js" to "app.min.js".
        This becomes a problem since the source files are used by the developers for debug.
        And we need the production files for deployment.

        An Ideal situation would be that
        <ul>
            <li>We keep the development environment Intact</li>
            <li>and generate production environment when required</li>
        </ul>

        In order to do so, we will optimize the whole project. Here are the steps for the same
        <b><u>Step 1</u></b>
        <p>
            Change the directory structure so we have a dedicated App (Dev) and Dist (Prod) area.

            <pre class="code">
source/
├──App
    ├── models/
    │   ├── Author.js
    │   ├── Book.js
    │   ├── BookIssue.js
    │   ├── Library.js
    │   ├── Publisher.js
    │   ├── User.js
    │   ├── Book.js
    ├── utils/
    │   ├── Logger.js
    ├── app.build.js
    ├── app.js
    ├── index.html
    ├── r.js
    ├── require.js
├──Dist
            </pre>
        </p>
        <b><u>Step 2</u></b>
        <p>
            Copy the following contents to app.build.js. Note appDir points to current directory and in our case the script
            directory also points to the current directory. We have copied the path and shim from app.js
            The dir is used to indicate the directory where the optimized output (entire app) will be put.

            The modules talks about the modules to be optimized. RequireJs will trace dependencies and optimize them also

            <pre class="code">
({
    appDir: ".",
    baseUrl: ".",
    paths: {
        "logger":"utils/Logger",
        "library": "models/Library",
        "user": "models/User",
        "book": "models/Book",
        "bookIssue": "models/BookIssue",
        "author": "models/Author",
        "publisher": "models/Publisher"
    },
    shim: {
        'logger': {
            exports: 'Logger'
        }
    },
    dir: "../Dist",
    modules: [
        {
            name: "app"
        }
    ]
})
            </pre>
        </p>
        <b><u>Step 3</u></b>
        <p>
            Run the following command and you will get the whole project copied in Dist Directory and it is optimized too.

            <pre class="code">
node r.js -o app.build.js
            </pre>

            There is no need to change app.js reference in index.html. If you open app.js (in Dist directory) you will see
            that it is optimized by requireJs.

            This is a much cleaner way to Optimize
        </p>
    <a href="#TOC">Table of Contents</a>
    </p>
</article>

<!--Example of Universal Module Definition  -->
<article>
    <h3 class="topic"><a name="umd">Moving to Universal Module Definition</a>  </h3>
    <p>
        There are 2 popular ways of Module Definitions in JavaScript. These are
        <ul>
            <li>RequireJs</li>
            <li>CommonJs</li>
        </ul>

        This means there are 3 ways of consuming a javascript library
        <ul>
            <li>Traditional Approach - Including script tags by hand</li>
            <li>RequireJs</li>
            <li>CommonJs</li>
        </ul>

        Now Image you developing a open source javascript library. You will need to cater
        to all the 3 environments. That is you now need to write your modules in a way to support
        all of the three.

        This brings us to the next topic "Universal Module Definition" aka UMD.

        UMD is not popular acronym yet, hence Google Search will not provide you much information here.

        UMD is a way to define you module in such a way that with one code write it is a valid
        <ul>
            <li>RequireJs Module</li>
            <li>CommonJs Module</li>
            <li>Normal JavaScript Module</li>
        </ul>

        Here is an example of User.js converted to an UMD Module
        <pre class="code">
(function(name, definition) {
//If module loaded using RequireJs
    if (typeof define == 'function' && define.amd) {
        define(definition);
    }
//else if module loaded using CommonJs
    else if (typeof module != 'undefined') {
        module.exports = definition();
    }
//else if module loaded directly
    else {
        this[name] = definition();
    }
}
('User',  function(){

    /**
     * User constructor
     * @param name - The name of the User
     * @constructor
     */
    var User = function(UserName){

        /**
         * Private Member Variable
         */
        var name = UserName;

        /**
         * Set User name
         * @param name
         */
        this.setName = function(UserName){
            name = UserName;
        }

        /**
         * Get User name
         * @return name
         */
        this.getName = function(){
            return name;
        }
    }
    return User;
}))

        </pre>

        <b><u>Self Study</u></b>
        See the above two examples in chapter 7 at your own pace
        <ul>
            <li><a href="chapter-7/index-requirejs.html" target="_blank">UMD With RequireJs</a> </li>
            <li><a href="chapter-7/index-plain.html" target="_blank">UMD Without RequireJs</a> </li>
        </ul>
    <a href="#TOC">Table of Contents</a>
    </p>
</article>
</section>
</section>
</body>
</html>